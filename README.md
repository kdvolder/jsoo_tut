Source material:
================

https://discuss.ocaml.org/t/it-there-a-tutorial-for-js-of-ocaml-with-simple-graphics/4636/7

In particular:
 - https://hackmd.io/@Swerve/HyhrqnFeF

Setting up project scaffolding
===============================

Assumption: you have opam installed, that's where we start.

Step 1: create a local switch

```
opam switch create .
eval $(opam env)
```

Step 2: install dune

```
opam install dune
```

Step 3: create dune project scaffold

```
dune init proj jsoo_tut
```

Step 4: install jsof_ocaml

```
opam install js_of_ocaml js_of_ocaml-ppx js_of_ocaml-lwt
```

Hello World
============

We are starting with the basic hello world that was generated by `dune init proj ...`.

This is a basic 'hello world' app that just prints out 'Hello World' on the terminal
when executed. The code for it is in `bin/main.ml` and looks like this:

```
let () = print_endline "Hello, World!"
```

To avoid confusing different 'versions' of our app as we progress. I have
renamed this to `hello_console.ml`.

To support js_of_ocaml we modified the `bin/dune` file as follows:

```
(executable
 (public_name hello_console)
 (modes js exe)
 (preprocess (pps js_of_ocaml-ppx))
 (name hello_console)
 (libraries jsoo_tut js_of_ocaml js_of_ocaml-lwt))
```

Building and Running
=====================

To 'build everything':

```
dune build
```

This generates a 'standard' executable here:

```
_build/install/default/bin/hello_console
```

Run it like so:

```
$ ./_build/install/default/bin/hello_console
Hello, World!
```

You can also run it using `dune exec`:

```
$ dune exec bin/hello_console.exe
Hello, World!                 
```

It also generates a js file here:

```
_build/default/bin/hello_console.bc.js
```

You can run this using nodejs:

```
$ node _build/default/bin/hello_console.bc.js
Hello, World!
```

Running in a Browser and using Dom
==================================

Now that we have some 'scaffold' to build things, let's start following along the
lines of the tutorial from here: https://hackmd.io/@Swerve/HyhrqnFeF

We need a html file that can be loaded in a browser and loads our 'js' file.

Create a directory for html files:

```
$ mkdir html
```

Add a `hello.html` with this contents:

```
<html>
  <head>
    <title>Jsoo_intro</title>
    <script type="text/javascript" src="../_build/default/bin/main.bc.js"></script>
  </head>
  <body>
  </body>
</html>
```

You can open this file in Chrome to 'run' it. For example on Unix and assuming we use Chrome
as our default browser we can do:

```
$ xdg-open html/hello-html
```

And it will open the page. Note: at this point it will just display a blank page as there is
nothing actually on the page. The `main.bc.js` script that is being loaded and executed just 
prints something onto the console. You can open "Chrome Dev Tools" and look for "Console output"
to check whether it worked:

![hello-console](screenshots/console-hello-world.png)




